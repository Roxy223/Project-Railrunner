<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ title }}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="wrap">
    <header class="head">
      <div class="title-block">
        <div>
          <h1>{{ title }}</h1>
          <div class="sub">(Via: Rembrand Centraal en Zaandam Centrum)</div>
        </div>
        <div class="header-image">
          <img src="{{ sample_image }}" alt="route example">
        </div>
      </div>
    </header>

    <form method="POST" action="/">
      <div class="timeline">

        <!-- top bus icon -->
        <div class="start-icon" aria-hidden="true">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="2" y="4" width="20" height="12" rx="2" fill="white" stroke="url(#g1)" stroke-width="1.5"/>
            <rect x="3.5" y="7.5" width="6" height="4" rx="0.6" fill="#eef2ff"/>
            <rect x="14" y="7.5" width="6" height="4" rx="0.6" fill="#eef2ff"/>
            <circle cx="7.2" cy="18.6" r="1.4" fill="#111"/>
            <circle cx="16.8" cy="18.6" r="1.4" fill="#111"/>
            <defs>
              <linearGradient id="g1" x1="0" x2="1">
                <stop offset="0" stop-color="#3b82f6"/>
                <stop offset="1" stop-color="#7c3aed"/>
              </linearGradient>
            </defs>
          </svg>
        </div>

        {% for stop in stops %}
        <div class="stop-row">

          <!-- left column: base/original time -->
          <div class="time-left">
            <div class="time-left-top">{{ stop.time }}</div>
          </div>

          <!-- middle area -->
          <div class="line-area">
            <div class="line-dot"></div>
          </div>

          <!-- right side -->
          <div class="right-card">
            <div class="card-row">

              <div class="stop-name">{{ stop.name }}</div>

              <div class="right-controls">

                <!-- Display original + delayed time -->
                <div class="times-inline">
                  <span class="orig {% if stop.delay > 0 %}crossed{% endif %}">
                    {{ stop.time }}
                  </span>

                  <span class="updated
                    {% if stop.delay > 0 %} red
                    {% elif stop.delay < 0 %} green
                    {% else %} normal
                    {% endif %}">
                    {{ stop.delayed_time }}
                  </span>

                  <span class="delay-label">
                    (+{{ stop.delay }} min)
                  </span>
                </div>

                <!-- Editing controls -->
                <div class="edit-row">
                  <label>Time</label>
                  <input type="time" name="time_{{ loop.index0 }}" value="{{ stop.time }}">

                  <label style="margin-left:6px;">Delay</label>
                  <input type="number" name="delay_{{ loop.index0 }}" value="{{ stop.delay }}" style="width:72px;">
                </div>

                <!-- Buttons -->
                <div class="button-row">
                  <button name="subtract_delay_{{ loop.index0 }}" class="small-btn">-1</button>
                  <button name="add_delay_{{ loop.index0 }}" class="small-btn">+1</button>
                </div>

              </div>
            </div>
          </div>

        </div>
        {% endfor %}

        <!-- bottom terminus icon -->
        <div class="end-icon" aria-hidden="true">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="4" y="4" width="16" height="16" rx="3" fill="white" stroke="url(#g2)" stroke-width="1.6"/>
            <defs>
              <linearGradient id="g2" x1="0" x2="1">
                <stop offset="0" stop-color="#3b82f6"/>
                <stop offset="1" stop-color="#7c3aed"/>
              </linearGradient>
            </defs>
          </svg>
        </div>

      </div>

      <div class="form-actions">
        <button type="submit" class="btn">Update</button>
        <button type="submit" name="reset_all" value="1" class="btn reset">Reset to defaults</button>
      </div>

    </form>
  </div>
</body>
</html>
